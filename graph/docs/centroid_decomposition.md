---
title: Centroid Decomposition (木の重心分解)
documentation_of: ../centroid_decomposition.cpp
---

## なにこれ
木構造の重心を求める．

## コンストラクタ
- `centroid_decomposition(E)`：木または森を表す隣接リスト `E` について前処理を行う．

## メンバ関数
- `get(x, tsize)`：頂点 `x` が含まれるサイズ `tsize` の木について，重心および重心分解後の各部分木に含まれる頂点とサイズの配列を返す．
- `del(x)`：頂点 `x` を削除する．

## 計算量
`E` に含まれる頂点数を $n$ とする．
- コンストラクタ：$O(n)$

対象となる木のサイズを $m$ とする．
- `get(x, tsize)`：$O(m)$
- `del(x)`：$O(1)$

## 備考
重心分解後の各部分木について，`get()` の返り値に含まれる頂点とサイズの情報を用いることで再帰的に重心分解を繰り返すことができる．

1レイヤーの重心分解につき部分木の最大サイズは半分以下となるため，頂点数1の木になるまで重心分解したときのレイヤー数は $O(\log n)$ である．
また，`del(x)` で重心を論理削除すれば `E` および `subsizes` を再初期化する必要はないため，1つのインスタンスを使い回すことができる．
これは全体 $O(n \log n)$ で実行することができる．

# 参考
- https://qiita.com/drken/items/4b4c3f1824339b090202
